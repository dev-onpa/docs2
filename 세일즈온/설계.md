# SalesOn 4 설계

## 공통
1. 테스트 코드 작성 
- 케이스별로 테스트 코드를 작성하여 개발 진행.
- 추가 기능 개발 시 이전 테스트를 실행하여 이전 기능에 대한 영향도 분석 및 판단.
- 모든 상태 코드 및 구분 코드는 Enum 코드로 생성 


## 주문
1. 공통 프로세스 
- 장바구니 -> 임시 주문 테이블 -> 주문 데이터 등록 (임시주문상태) -> 결제완료 -> 주문데이터 상태 변경
- 주문 상태 코드를 숫자 형식에서 Enum (형태의 데이터로 저장)

2. 배송비 부과 정책의 단순화 
- 기존: 무료 / 판매자기준 / 출고지 기준 / 상품조건부 / 개당배송비 / 고정배송비

```
- 무료
- 조건부무료: 묶음코드 기준, 금액 기준 
- 상품별 부과: 수량에 따른 배송비 부과  
```

```
- 무료
- 조건부무료 (묶음불가): 동일 상품에 대한 조건부 무료 정책
- 조건부무료 (묶음가능): 동일 배송비 및 동일 배송 조건으로 묶음 가능으로 선택한 상품에 대해 배송비 정책 적용 
- 고정배송비: 수량에 따른 배송비 부과  
```



3. 주문 누락 처리 
- DRAFT 상태를 추가하여 주문 데이터를 저장함.
- 최종 결제 완료 시 상태를 변경하여 주문서 생성 
- 향후 주문 데이터 처리 -> 결제 분리

4. 주문 처리 속도 
- 메시지 발송 / 포인트 적립 등 ApplicationEvent 로 분리
- 주문 처리 후 관련 이벤트 발생 
- 비동기로 데이터 처리 

5. 결제 금액 계산 처리 및 소수점 처리 변경
- 데이터 타입 int (float) -> 모든 금액 처리를 위한 데이터를 BigDecimal 형태로 변경.
- 다른 통화나 소수점 처리 등 정책이 바뀔 경우의 대비 및 소수점의 정확한 계산.
- 할인금액 : 소수점 삭제 (ROUND_DOWN)
- 상품판매가 기준 할인금액 적용 (*)

6. 할인 정보 테이블 분리
- 다양한 할인 정보가 등록될 수 있도록 테이블 분리 
- 할인 내역을 상품판매가 기준으로 상세히 확인할 수 있음. 
- 할인 내역에 대한 통계 자료 구성.

7. 주문 단위 할인이 가능해야함.
- 주문 쿠폰 적용이 가능하도록 설계.
- 프로모션 코드를 이용한 할인 가능 구조 설계 (비회원 할인 가능)

8. 클레임 테이블 통합
- 교환 / 반품 신청 테이블 통합 

9.환불 처리 시 
- 환불 처리 시 환불 데이터와 결제 취소 데이터 분리 
- 환불 처리 시 특정 결제 수단의 일시적 장애로 환불 처리가 안되는 부분
- 여러 결재 수단이 복합된 경우 트랜잭션 롤백이 안되는 문제 (결제수단 1이 취소 완료된 후 결제 수단2가 취소 오류가 발생한 경우)
  (PG + 외부 결제 수단 (okcashback, lpoint 등 기타 결제 수단 동시 결제 시 ))
- 환불 결제 수단 별 취소가 안되는 경우 개별 취소할 수 있도록 트랜잭션 분리 

9. 정산 프로세스
-  

== 상품 : 기간별 상품 환불 정책 
* 예약 상품
* 기간 


== 신입, 경력
- 신규 채용 
- 일학습 병행제...

- 개발 년차별 개발 스택 구분
- 업무별 구분..

- 정부과제 인테리어...

- 이후 개발쪽 파트 (주문쪽, 상품쪽 ) => 영향도 분석 (메인 + 행동대장)



