# 192.168.123.22 번 서버 세팅 
> 2019.08.20 기존 22번 서버가 자주 다운되어 새로 설치함  

## 내용
### 1. centos7 설치 (박이사님)
- centos7 설치 
- apache 설정 + mod_jk 
- tomcat 설치 

 
### 2. jenkins / m2 / sonatype-work 데이터 이동 (신극창)
- root 폴더의 .jenkins, .subversion, .m2 폴더 압축 후 scp로 전송 
- 이동한 파일의 압축 해제 

### 3. Apache 설정 (신극창)

#### module 파일 전송 및 설정 
- mod_dav_svn.so, mod_ssl.so, mod_authz_svn.so 
- /etc/conf.module.d/00-dav.conf
```
# SVN
LoadModule dav_svn_module modules/mod_dav_svn.so
LoadModule authz_svn_module   modules/mod_authz_svn.so
```

#### SSL 설정
ssl 인증서 전송 및 설정 

- /etc/conf.module.d/00-ssl.conf
```
LoadModule ssl_module modules/mod_ssl.so
```

#### vhost.conf / ssl.conf 설정 
- /etc/conf.d/ 폴더에 vhost.conf / ssl.conf 설정
- workers.properties
- workermap.xxxx.properties 수 

vhost.con / ssl.conf 설정 


### 4. 톰캣 설정 
- tomcat-jenkins / tomcat-onlinepowers / tomcat-saleson3 / tomcat-project 4대 구성 
- /etc/systemd/system/ 폴더엔 tomcat-xxx.service 파일 생성 
- 서비스 등록 
```
$ systemctl daemon-reload

$ systemctl enable tomcat-jenkins.service
$ systemctl enable tomcat-onlinepowers.service
$ systemctl enable tomcat-saleson3.service
$ systemctl enable tomcat-project.service
```



### 5. /home 데어터 복사 
-  barrels_erp  bonif  checkin  coding  dev  hanil  hsp  ibksmilebank  license  powers  saleson  svn 으로만 운영함.


### 6. selinux 설정 (httpd_content)
- content 데이터가 아파치에서 안보이는 증상 
```
$ chcon -R -t httpd_sys_content_t /home/saleson
```



### 7. SVN Commit이 안됨
- 커밋시 아래 오류가 발생함.
```
svn: E000013: Commit failed (details follow):
svn: E000013: could not begin a transaction
```
- setenforce 0 으로 SELinux 설정을 끄니 커밋이 됨. (SELinux 문제 )

- selinux 쓰기 권한 추가함.

```
$ chcon -R -t httpd_sys_content_rw_t /home/svn
```

- 아파치랑 연결 안되어 있다면 아래와 같이 처리하겠지?
```
$ chcon -R -t svnserve_content_rw_t /home/svn
```
